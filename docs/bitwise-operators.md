# 位运算符和复合赋值运算符

LongLang 支持完整的位运算符和复合赋值运算符，语法与 C/C++/Java/C# 完全一致。

## 位运算符

| 运算符 | 名称 | 示例 | 说明 |
|--------|------|------|------|
| `&` | 按位与 | `a & b` | 两个位都为1时结果为1 |
| `\|` | 按位或 | `a \| b` | 任一位为1时结果为1 |
| `^` | 按位异或 | `a ^ b` | 两个位不同时结果为1 |
| `~` | 按位取反 | `~a` | 一元运算符，0变1，1变0 |
| `<<` | 左移 | `a << n` | 左移 n 位，相当于乘以 2^n |
| `>>` | 右移 | `a >> n` | 右移 n 位，相当于除以 2^n |

### 示例

```longlang
var a = 0b1100  // 12
var b = 0b1010  // 10

// 按位与
a & b    // 0b1000 = 8

// 按位或
a | b    // 0b1110 = 14

// 按位异或
a ^ b    // 0b0110 = 6

// 按位取反
~0       // -1 (所有位取反)
~1       // -2

// 左移
1 << 4   // 16

// 右移
16 >> 2  // 4

// 组合使用
(5 << 2) & 0xFF  // 20
```

## 复合赋值运算符

| 运算符 | 等价于 | 示例 |
|--------|--------|------|
| `+=` | `a = a + b` | `x += 5` |
| `-=` | `a = a - b` | `x -= 3` |
| `*=` | `a = a * b` | `x *= 2` |
| `/=` | `a = a / b` | `x /= 4` |
| `%=` | `a = a % b` | `x %= 3` |
| `&=` | `a = a & b` | `x &= 0xFF` |
| `\|=` | `a = a \| b` | `x \|= 0x01` |
| `^=` | `a = a ^ b` | `x ^= mask` |
| `<<=` | `a = a << b` | `x <<= 2` |
| `>>=` | `a = a >> b` | `x >>= 1` |

### 示例

```longlang
var x = 10

x += 5   // x = 15
x -= 3   // x = 12
x *= 2   // x = 24
x /= 4   // x = 6
x %= 4   // x = 2

// 位运算复合赋值
x = 0b1111
x &= 0b1010  // x = 10
x |= 0b0101  // x = 15
x ^= 0b0101  // x = 10

// 移位复合赋值
x = 1
x <<= 4  // x = 16
x >>= 2  // x = 4

// 数组索引复合赋值
var arr = []int{10, 20, 30}
arr[0] += 5   // arr[0] = 15
arr[1] *= 2   // arr[1] = 40
```

## 运算符优先级

从高到低（符合 C 语言标准）：

| 优先级 | 运算符 | 说明 |
|--------|--------|------|
| 最高 | `~` `!` `-`(负号) | 一元运算符 |
| | `*` `/` `%` | 乘除取模 |
| | `+` `-` | 加减 |
| | `<<` `>>` | 移位 |
| | `<` `<=` `>` `>=` | 比较 |
| | `==` `!=` | 相等 |
| | `&` | 按位与 |
| | `^` | 按位异或 |
| | `\|` | 按位或 |
| | `&&` | 逻辑与 |
| | `\|\|` | 逻辑或 |
| | `?:` | 三元运算符 |
| 最低 | `=` `+=` `-=` 等 | 赋值 |

### 注意事项

```longlang
// 由于 & 优先级低于 ==，需要使用括号
(5 & 3) == 1  // true，正确
5 & 3 == 1    // 错误！解析为 5 & (3 == 1)

// + - 优先级高于 << >>
1 + 2 << 3    // (1 + 2) << 3 = 24，不是 1 + (2 << 3) = 17
```

## 类型限制

- 位运算符只能用于整数类型（`int`, `i8`, `i16`, `i32`, `i64`, `uint`, `u8`, `u16`, `u32`, `u64`, `byte`）
- 移位位数不能为负数
- 按位取反 `~` 是一元运算符，只能用于整数

